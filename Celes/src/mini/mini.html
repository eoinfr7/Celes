<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' data: celes-stream: https: http:; img-src * data:; media-src * data: celes-stream:;" />
    <title>Celes Mini</title>
    <style>
      html,body{margin:0;background:#0b0b10;color:#fff;font-family:system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji;}
      .bar{display:flex;align-items:center;gap:10px;padding:8px 10px}
      .thumb{width:48px;height:48px;border-radius:6px;background:#222;overflow:hidden;display:flex;align-items:center;justify-content:center}
      .title{font-size:12px;line-height:1.2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:180px}
      .btn{background:#1a1a22;color:#fff;border:1px solid #333;border-radius:999px;padding:6px 10px;cursor:pointer}
      .btn:hover{background:#222}
      .side{margin-left:auto;display:flex;align-items:center;gap:8px}
      input[type=range]{accent-color:#4a9eff}
    </style>
  </head>
  <body>
    <div class="bar">
      <div class="thumb"><img id="thumb" alt="" style="width:100%;height:100%;object-fit:cover;display:none"/></div>
      <div>
        <div id="title" class="title">Nothing playing</div>
        <div id="artist" style="font-size:11px;color:#aaa" class="title"></div>
      </div>
      <button id="prev" class="btn">⏮</button>
      <button id="play" class="btn">▶</button>
      <button id="next" class="btn">⏭</button>
      <div class="side">
        <input id="vol" type="range" min="0" max="1" step="0.01" value="0.8" />
        <button id="close" class="btn" title="Close mini player">✕</button>
      </div>
    </div>
    <script>
      const { ipcRenderer } = require('electron')
      // Relay controls
      document.getElementById('play').onclick = ()=> ipcRenderer.invoke('toggle-play')
      document.getElementById('prev').onclick = ()=> ipcRenderer.invoke('previous-track')
      document.getElementById('next').onclick = ()=> ipcRenderer.invoke('next-track')
      document.getElementById('vol').oninput = (e)=> ipcRenderer.invoke('set-volume', Number(e.target.value))
      document.getElementById('close').onclick = ()=> window.close()

      ipcRenderer.on('mini-now-playing', (e, data)=>{
        document.getElementById('title').textContent = data?.title || 'Nothing playing'
        document.getElementById('artist').textContent = data?.artist || ''
        const img = document.getElementById('thumb')
        if (data?.thumbnail){ img.src = data.thumbnail; img.style.display='block' } else { img.style.display='none' }
      })
    </script>
  </body>
  </html>


